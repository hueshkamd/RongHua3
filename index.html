<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>民国动画</title>
    <style>
        body {
          margin: 0;
          padding: 0;
          background-color: #f0e6d2;
          display: flex;
          justify-content: center;
          align-items: flex-start; /* 修改为flex-start，允许页面滚动 */
          min-height: 150vh; /* 增加页面高度，允许滚动 */
          overflow-x: hidden;
        }
        /* 容器样式 */
        .scene-container {
            position: relative;
            width: 640px;
            height: 1030px;
            overflow: hidden;
            margin-top: 50px; /* 增加顶部间距 */
        }

        /* 背景图样式 */
        .background {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* 动画元素样式 */
        .animate-element {
            position: absolute;
            transition: all 1.5s ease-out; 
        }
        /* 民国*/
        #img2 {
            top: -120px; 
            left: 75%;
            width: 70px;
            cursor: pointer; /* 添加鼠标指针样式 */
            z-index: 4; /* 确保在最上层可点击 */
        }

        /* 点击后文字框的样式 */
        .center-image {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0; /* 初始透明 */
            transition: opacity 1s ease-out; /* 渐出动画 */
            max-width: 100%;
            max-height: 100%;
            z-index: 5;
            pointer-events: none;
        }
		/* 文字样式*/
		.center-text {
		    position: absolute;
		    top: 49%;
		    left: 51%;
		    transform: translate(-50%, -50%);
		    opacity: 0; /* 初始透明 */
		    transition: opacity 1s ease-out; /* 渐出动画 */
		    max-width: 100%;
		    max-height: 100%;
		    z-index: 6;
		    pointer-events: none;
		}

        /* 新增元素样式 */
        .fog {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s ease-out;
            z-index: 10;
            pointer-events: none;
        }

        .hualing {
            position: absolute;
            top: 38%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 100%;
            max-height: 100%;
            opacity: 0;
            transition: opacity 1s ease-out;
            z-index: 11;
            pointer-events: none;
        }

        .text-box {
            position: absolute;
            top: 73%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 90%;
            max-height: 80%;
            opacity: 0;
            transition: opacity 1s ease-out 0.5s;
            z-index: 12;
            pointer-events: none;
        }

        .text-content {
            position: absolute;
            top: 73%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 80%;
            max-height: 70%;
            opacity: 0;
            transition: opacity 1s ease-out 1s;
            z-index: 13;
            pointer-events: none;
        }

        .start-btn {
            position: absolute;
            bottom: 45px;
            left: 77%;
            transform: translate(-50%, 0);
            max-width: 150px;
            opacity: 0;
            transition: opacity 1s ease-out 1.5s;
            z-index: 14;
            cursor: pointer;
        }

        /* 缩放动画 */
        @keyframes pulse {
            0% { transform: translate(-50%, 0) scale(1); }
            50% { transform: translate(-50%, 0) scale(1.1); }
            100% { transform: translate(-50%, 0) scale(1); }
        }

        .pulse {
            animation: pulse 1.5s infinite ease-in-out;
        }

        /* 添加提示区域 */
        .scroll-hint {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #666;
            font-size: 14px;
            z-index: 999;
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <div class="scene-container">
        <img src="rh6/fa5aa5344466c37f8d1b49f011b9c46e.png" class="background" alt="民国背景">
        <img src="rh6/c89f4a11379762c4f9e16bcb2cf0ac3e.png" class="animate-element" id="img2" alt="添加图片二">
        <img src="rh6/61a678f208fbaaa311b01416f7756381.png" class="center-image" id="img3" alt="添加图片三">
        <img src="rh6/e1486758c0401bb1b8f979cd03dd0a17.png" class="center-text" id="img4" alt="添加图片四">
        
        <!-- 新增元素 -->
        <img src="rh6/c3f5e9427e0ca331318c8c72bfc49402.png" class="fog" id="fog" alt="灰雾">
        <img src="rh6/b51a45769df545773eee5b52f3395840.png" class="hualing" id="hualing" alt="花灵">
        <img src="rh6/1049912e592100ff409228f85c496fc0.png" class="text-box" id="textBox" alt="文本框">
        <img src="rh6/5ab933c170b42c8bc0c1973f2d8cf6ae.png" class="text-content" id="textContent" alt="文本">
        <img src="rh6/e2a1c7c047f65cfda0df28a8b198a000.png" class="start-btn" id="startBtn" alt="开始">
    </div>
    
    <div class="scroll-hint">上滑查看更多</div>

    <script>
        // 等待页面完全加载
        window.addEventListener('DOMContentLoaded', () => {
            // 背景图加载处理
            const background = document.querySelector('.background');
            if (background.complete) {
                animateInitial();
            } else {
                background.addEventListener('load', animateInitial);
            }

            // 初始动画
            function animateInitial() {
                document.getElementById('img2').style.top = '100px';
                
                // 确保img2加载完成后绑定点击事件
                const img2 = document.getElementById('img2');
                if (img2.complete) {
                    bindClickEvent();
                } else {
                    img2.addEventListener('load', bindClickEvent);
                }
            }

            // 绑定点击事件
            function bindClickEvent() {
                const img2 = document.getElementById('img2');
                // 测试点击是否生效
                img2.addEventListener('click', function() {
                    console.log('图片二被点击了！');
                    
                    // 渐出图片三
                    const img3 = document.getElementById('img3');
                    img3.style.opacity = '1';
                    
                    // 延迟后渐出图片四
                    setTimeout(() => {
                        const img4 = document.getElementById('img4');
                        img4.style.opacity = '1';
                        
                        // 点击后启用滚动检测
                        enableScrollDetection();
                    }, 500);
                });
                
                // 也可以添加触摸事件支持移动端
                img2.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    this.click();
                });
            }
            
            // 滚动检测开关
            let scrollDetectionEnabled = false;
            let hasTriggeredNextScene = false;
            
            // 启用滚动检测
            function enableScrollDetection() {
                scrollDetectionEnabled = true;
                console.log('滚动检测已启用');
            }

            // 增强的滚动检测
            function checkScroll() {
                if (!scrollDetectionEnabled || hasTriggeredNextScene) return;
                
                // 方法1: 检测滚动位置
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                // 方法2: 检测鼠标滚轮
                // 如果滚动超过一定距离或有向上滚动动作
                if (scrollTop > 30) {
                    triggerNextScene();
                }
            }
            
            // 触摸滑动检测
            let touchStartY = 0;
            let touchMoveY = 0;
            
            // 移动端触摸事件
            document.addEventListener('touchstart', (e) => {
                touchStartY = e.touches[0].clientY;
            }, { passive: true });
            
            document.addEventListener('touchmove', (e) => {
                if (!scrollDetectionEnabled || hasTriggeredNextScene) return;
                
                touchMoveY = e.touches[0].clientY;
                const diff = touchStartY - touchMoveY;
                
                // 上滑超过30px触发
                if (diff > 30) {
                    triggerNextScene();
                }
            }, { passive: true });
            
            // 鼠标滚轮事件
            document.addEventListener('wheel', (e) => {
                if (!scrollDetectionEnabled || hasTriggeredNextScene) return;
                
                // 向上滚动
                if (e.deltaY < 0) {
                    triggerNextScene();
                }
            }, { passive: false });
            
            // 窗口滚动事件
            window.addEventListener('scroll', checkScroll);
            
            // 点击容器也能触发（备用方案）
            document.querySelector('.scene-container').addEventListener('click', function(e) {
                if (!scrollDetectionEnabled || hasTriggeredNextScene) return;
                
                // 防止点击img2时触发
                if (e.target.id !== 'img2') {
                    triggerNextScene();
                }
            });

            // 触发下一场景动画
            function triggerNextScene() {
                if (hasTriggeredNextScene) return;
                hasTriggeredNextScene = true;

                console.log('触发上滑动画');
                
                // 隐藏提示
                document.querySelector('.scroll-hint').style.display = 'none';
                
                // 显示灰雾
                const fog = document.getElementById('fog');
                fog.style.opacity = '1';

                // 延迟显示花灵
                setTimeout(() => {
                    const hualing = document.getElementById('hualing');
                    hualing.style.opacity = '1';
                }, 800);

                // 显示文本框
                setTimeout(() => {
                    const textBox = document.getElementById('textBox');
                    textBox.style.opacity = '1';
                }, 1500);

                // 显示文本
                setTimeout(() => {
                    const textContent = document.getElementById('textContent');
                    textContent.style.opacity = '1';
                }, 2000);

                // 显示开始按钮并添加缩放动画
                setTimeout(() => {
                    const startBtn = document.getElementById('startBtn');
                    startBtn.style.opacity = '1';
                    startBtn.classList.add('pulse');
                }, 2500);
            }
        });
    </script>
</body>
</html>